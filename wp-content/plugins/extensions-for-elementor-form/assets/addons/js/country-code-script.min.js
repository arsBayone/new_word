class CoolFormCCFEF extends elementorModules.frontend.handlers.Base{getDefaultSettings(){return{selectors:{inputTelTextArea:"textarea.ccfef_country_code_data_js",intlInputSpan:".ccfef-editor-intl-input",submitButton:"div.cool-form__submit-group button",form:".cool-form"}}}getDefaultElements(){const t=this.getSettings("selectors");return{$textArea:this.$element.find(t.inputTelTextArea),$intlSpanElement:this.$element.find(t.intlInputSpan),$submitButton:this.$element.find(t.submitButton),$form:this.$element.find(t.form)}}bindEvents(){this.telId=new Array,this.includeCountries={},this.excludeCountries={},this.defaultCountry={},this.commonCountries={},this.dialCodeVisibility={},this.countryStrictMode={},this.iti={},this.getIntlUserData(),this.appendCountryCodeHandler(),this.addCountryCodeInputHandler(),this.customFlags(),this.removeInputTelSpanEle(),this.intlInputValidation()}handleTelWithMdcFields(t){function e(){const t=o.find(".iti__dropdown-content");o.nextAll(".cool-form__field-group").each(function(){t.hasClass("iti__hide")?this.style.zIndex="initial":this.style.zIndex="-1"})}const i=t.telInput,n=i.closest(".cool-form__field-group"),o=jQuery(n),s=o.find(".mdc-floating-label"),l=o.find("input"),r=o.find(".mdc-notched-outline__notch"),a=o.find(".mdc-notched-outline__leading");let d=l.eq(1).prev(".iti__country-container").find(".iti__selected-dial-code");if(d.css("visibility","hidden"),""!==l.eq(1).val()?d.css("visibility","visible"):d.css("visibility","hidden"),o.nextAll().length>0){const t=o.nextAll();if(t.length>0){const e=t[0],i=t[1],n=t=>t&&t.classList&&t.classList.contains("cool-form__submit-group"),s=o.hasClass("has-width-100")?n(e):n(e)||n(i);s&&(o.css({"margin-bottom":"25px"}),o.find(".iti__country-list").css({"max-height":"100px"}))}}s.css("left","57px"),l.eq(1).on("blur",()=>{""!==l.eq(1).val()?d.css("visibility","visible"):d.css("visibility","hidden")}),l.eq(1).on("focus",()=>{d.css("visibility","visible"),s.css({left:"57px","background-color":"white"});const t=getComputedStyle(r[0]).getPropertyValue("border-bottom");r.css({"border-top":t})}),o.on("click",t=>{e()}),l.eq(0).on("mouseover",()=>{const t=getComputedStyle(a[0]).getPropertyValue("border-bottom-width");r.css({"border-top-width":t,"border-top-color":"black"})}),o.on("mouseover",t=>{const i=getComputedStyle(a[0]).getPropertyValue("border-bottom-width");r.css({"border-top-width":i,"border-top-color":"black"}),e()}),o.on("mouseleave",t=>{const i=getComputedStyle(a[0]).getPropertyValue("border-bottom-width"),n=getComputedStyle(a[0]).getPropertyValue("border-right-color");r.css({"border-top-width":i,"border-top-color":n}),e()})}appendCountryCodeHandler(){this.telId.forEach(t=>{this.addCountryCodeIconHandler(t.formId,t.fieldId,t.customId)})}addCountryCodeInputHandler(){const t=this.iti;Object.keys(t).forEach(e=>{const i=t[e],n=i.telInput;this.handleTelWithMdcFields(i);let o=i.getSelectedCountryData(),s=`+${o.dialCode}`,l=!1;const r=()=>{l=!1},a=t=>{this.handleTelWithMdcFields(i),this.customFlags();const n=i.getSelectedCountryData(),a=`+${n.dialCode}`;if("keydown"===t.type||"input"===t.type)l=!0,clearTimeout(r),setTimeout(r,400),o.dialCode!==n.dialCode?o=n:o.dialCode===n.dialCode&&o.iso2!==n.iso2&&i.setCountry(o.iso2);else if("countrychange"===t.type){if(l)return;o=n}t.currentTarget.value.startsWith(a.replace("+",""))?this.updateCountryCodeHandler(t.currentTarget,"+",s,this.dialCodeVisibility[e]):(this.updateCountryCodeHandler(t.currentTarget,a,s,this.dialCodeVisibility[e]),s=a)};n.addEventListener("keydown",a),n.addEventListener("input",a),n.addEventListener("countrychange",a)})}addCountryCodeIconHandler(t,e,i){const n=CCFEFCustomData.pluginDir+"assets/addons/intl-tel-input/js/utils.min.js",o=jQuery(`.elementor-widget.elementor-widget-cool-form[data-id="${t}"] .is-field-type-tel.cool-form__field-group input[type="tel"]#${i}`)[0];if(void 0!==o){let i=[],s=[],l="in";const r=["in","us","gb","ru","fr","de","br","cn","jp","it"],a=`${t}${e}`;if(this.includeCountries.hasOwnProperty(a)&&this.includeCountries[a].length>0&&(l=this.includeCountries[a][0],i=[...this.includeCountries[a]]),this.excludeCountries.hasOwnProperty(a)&&this.excludeCountries[a].length>0){let t=r.filter(t=>!this.excludeCountries[a].includes(t));l=t[0],s=[...this.excludeCountries[a]]}this.defaultCountry[a]&&""!==this.defaultCountry[a]&&(l=this.defaultCountry[a]);const d=window.intlTelInput(o,{initialCountry:l,utilsScript:n,dialCodeVisibility:this.dialCodeVisibility[a],strictMode:"yes"===this.countryStrictMode[a],separateDialCode:"separate"===this.dialCodeVisibility[a],formatOnDisplay:!1,formatAsYouType:!0,autoFormat:!1,containerClass:"cfefp-intl-container",useFullscreenPopup:!1,onlyCountries:i,excludeCountries:s,customPlaceholder:(t,e)=>{if(this.commonCountries[a])return"No country found";if(!e||!t||!e.dialCode)return"No country found";let i=t;"in"===e.iso2&&(i=t.replace(/^0+/,""));const n="separate"===this.dialCodeVisibility[a]||"hide"===this.dialCodeVisibility[a]?`${i}`:`+${e.dialCode} ${i}`;return n}});if("separate"===this.dialCodeVisibility[a]){const t=document.createElement("style");t.textContent="\n                    .cfefp-intl-container .iti__selected-dial-code,\n                    .cfefp-intl-container .iti__selected-flag {\n                        color: var(--e-form-field-text-color, #7a7a7a) !important;\n                    }\n                    .cfefp-intl-container .iti__selected-dial-code {\n                        font-size: inherit !important;\n                        font-family: inherit !important;\n                        line-height: inherit !important;\n                    }\n                ",document.head.appendChild(t)}const c=document.querySelector(`.elementor-widget.elementor-widget-form[data-id="${t}"] .ccfef-editor-intl-input[data-field-id="${e}"]`),u=c?c.getAttribute("data-common-countries"):"";if("same"===u&&this.commonCountries[a]&&""!==i&&""!==s){const t=d.countryList;t&&t.classList.contains("iti__country-list")&&(t.style.display="none")}else{const t=d.countryList;if(t&&t.classList.contains("iti__country-list")){const e=t.querySelectorAll(".iti__country");e.forEach(function(t){const e=t.getAttribute("data-country-code");s.includes(e)&&(t.style.display="none")});const n=Array.from(e).filter(t=>"none"!==t.style.display),o=n.filter(t=>{const e=t.getAttribute("data-country-code");return i.includes(e)});if(o.length>0){const t=o.find(t=>"true"===t.getAttribute("aria-selected"));if(!t){const t=o[0];t.setAttribute("aria-selected","true");const e=t.getAttribute("data-country-code");d.setCountry(e)}}}}o.removeAttribute("pattern"),this.iti[t+e]=d,this.setInitialCountry(d,s,a,o)}}setInitialCountry(t,e,i,n){const o=this.defaultCountry[i]||"",s=["in","us","gb","ru","fr","de","br","cn","jp","it"],l=t.countries.map(t=>t.iso2);t.telInput;jQuery(n).closest(".elementor-field-type-country").hasClass("elementor-field-required")&&jQuery(n).closest(".elementor-field-type-country").hasClass("cfef-hidden")&&(""===o?(t.setCountry("us"),jQuery(n).val("United States"),jQuery(n).focus(),jQuery(n).trigger("change")):(t.setCountry(o),jQuery(n).val(o),jQuery(n).focus(),jQuery(n).trigger("change")));const r=i=>{if(l.length<=0)return;const n=isNaN(i)&&i?i.toLowerCase():"";if(n&&l.includes(n))t.setCountry(n);else if(o&&l.includes(o))t.setCountry(o);else{const i=s.filter(t=>!e.includes(t)&&l.includes(t)),n=i.length>0?i[0]:l[0];t.setCountry(n)}const r=t.getSelectedCountryData();r.hasOwnProperty("iso2")};o&&r(o)}updateCountryCodeHandler(t,e,i,n){let o=t.value;if(!(e&&"+undefined"===e||["","+"].includes(o)))if(e!==i&&(o=o.replace(new RegExp(`^\\${i}`),"")),o.startsWith(e)){if(o.length>12){const i=e.replace("+",""),n=`+${i}${i}`;o.startsWith(n)&&(t.value=`+${o.slice(e.length)}`)}}else o=o.replace(/\+/g,""),t.value="separate"===n||"hide"===n?o:e+o}customFlags(){const t=this.$element.find(".cfefp-intl-container .iti__country-container .iti__flag:not(.iti__globe)");t.each(function(){const t=this,e=t.className.split(" ");if(e[1]){const i=e[1].split("__")[1],n=CCFEFCustomData.pluginDir+`assets/addons/flags/${i}.svg`;t.style.backgroundImage=`url('${n}')`}})}removeInputTelSpanEle(){this.$element.find("span.ccfef-editor-intl-input").remove()}getIntlUserData(){const t=this.elements.$intlSpanElement,e=[];t.each((t,i)=>{const n=jQuery(i),o=n.data("include-countries"),s=n.data("exclude-countries"),l=n.data("defaultCountry"),r=n.data("common-countries"),a=n.data("id"),d=n.data("field-id"),c=n.data("dial-code-visibility"),u=n.data("strict-mode"),f=n.closest(".elementor-element.elementor-widget-cool-form").data("id"),h=`${f}${d}`;if("same"===r&&""===o&&""!==s)this.commonCountries[h]=!0;else{if(""!==o&&isNaN(o)){const t=o.split(",");this.includeCountries[h]=t}if(""!==s&&isNaN(s)){const t=s.split(",");this.excludeCountries[h]=t}if("same"!==r&&""!==o&&""!==s&&isNaN(o)){const t=o.split(",").map(t=>t.trim());if(isNaN(s)){const e=s.split(",").map(t=>t.trim()),i=t.every(t=>e.includes(t));i&&(this.commonCountries[h]=!0)}}""!==c&&(this.dialCodeVisibility[h]=c),""!==u&&(this.countryStrictMode[h]=u),""!==l&&(this.defaultCountry[h]=l)}e.includes(h)||(this.telId.push({formId:f,fieldId:d,customId:a}),e.push(h))})}validateTelInputs(t,e="submit"){const i=this.iti;Object.keys(i).length>0&&Object.keys(i).forEach(n=>{const o=i[n],s=o.telInput;let l=s.closest("label"),r=mdc.textfield.MDCTextField.attachTo(l);if(""!==s.value){s.value=s.value.replace(/[^0-9+]/g,"");const t=o.getSelectedCountryData(),e=`+${t.dialCode}`;"separate"!==this.dialCodeVisibility[n]&&"hide"!==this.dialCodeVisibility[n]||s.value.startsWith("+")||(s.value=e+s.value)}const a=s.closest(".cool-form__field-group"),d=a.querySelector(".cfefp-intl-container");d&&s.offsetHeight&&d.style.setProperty("--cfefp-intl-tel-button-height",`${s.offsetHeight}px`);const c=jQuery(s).parent();c.find("span.elementor-message").remove();const u=CCFEFCustomData.errorMap;let f='<span class="elementor-message elementor-message-danger elementor-help-inline elementor-form-help-inline" role="alert">';if(""!==s.value)if(o.isValidNumber()){jQuery(s).closest(".cfefp-intl-container").removeClass("elementor-error"),r.valid=!0,r.trailingIcon.root.style.display="none",r.helperText.foundation.adapter.setContent("");const t=this.elements.$form.find(".mask-error").filter(function(){return"flex"===jQuery(this).css("display")});0===t.length&&this.elements.$form[0].classList.remove("elementor-form-waiting")}else{const i=o.getValidationError();if(void 0!==i&&u[i]){if("separate"===this.dialCodeVisibility[n]||"hide"===this.dialCodeVisibility[n]){const t=o.getSelectedCountryData(),e=`+${t.dialCode}`;s.value.startsWith(e)&&(s.value=s.value.substring(e.length))}f+=u[i]+"</span>",jQuery(s).closest(".cfefp-intl-container").addClass("elementor-error"),r.valid=!1,r.trailingIcon.root.style.display="initial",r.helperText.foundation.adapter.setContent(u[i]),t.preventDefault(),this.elements.$form.find(".is-field-type-recaptcha_v3").length>0&&t.stopImmediatePropagation(),"submit"===e&&this.elements.$form[0].classList.add("elementor-form-waiting")}}})}intlInputValidation(){this.elements.$submitButton.on("click",t=>{this.validateTelInputs(t,"button")}),this.elements.$form.on("submit",t=>{this.validateTelInputs(t,"submit")})}}jQuery(window).on("elementor/frontend/init",()=>{const t=t=>{elementorFrontend.elementsHandler.addHandler(CoolFormCCFEF,{$element:t})};elementorFrontend.hooks.addAction("frontend/element_ready/cool-form.default",t)});